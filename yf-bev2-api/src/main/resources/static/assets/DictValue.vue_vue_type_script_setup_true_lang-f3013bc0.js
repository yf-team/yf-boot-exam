import{a as e,b as l,c as a}from"./index-77bd7a66.js";import{d,r as i,I as t,y as o,z as s,m as c,p as n,o as u,c as r,f as p,w as m,i as h,A as C,s as y,K as w}from"./index-20708d06.js";const v={"element-loading-text":"加载中..."},V=d({__name:"DictValue",props:{dicCode:{type:String,default:""},dictType:{type:Number,default:1}},setup(d){const V=d,f=i(),b=i(!1);t((()=>V.dicCode),(e=>{e&&g()}));const g=()=>{b.value=!0,e({dicCode:V.dicCode}).then((e=>{f.value=e.data,b.value=!1})).catch((()=>{b.value=!1}))},k=()=>{f.value||(f.value=[]),f.value.push({parentId:0,title:"",dicValue:"",dicCode:V.dicCode})},x=a=>{a.dicValue&&a.title||1!==V.dictType?a.title||2!==V.dictType?l(a).then((()=>{w({showClose:!0,message:"保存成功！",type:"success"}),1===V.dictType?(b.value=!0,e({dicCode:V.dicCode}).then((e=>{for(const l of e.data)for(const e of f.value)l.dicValue===e.dicValue&&(e.id=l.id);b.value=!1})).catch((()=>{b.value=!1}))):g()})):w({showClose:!0,message:"分类名称不能为空！",type:"warning"}):w({showClose:!0,message:"字典名称和值不能为空！",type:"warning"})};return o((()=>{g()})),(e,l)=>{const d=s("el-input"),i=s("el-table-column"),t=s("el-button"),o=s("el-table"),_=c("loading");return n((u(),r("div",v,[p(o,{data:f.value,"tree-props":{children:"children",hasChildren:"hasChildren"},"default-expand-all":"","row-key":"id",stripe:"",style:{width:"100%"}},{default:m((()=>[p(i,{label:"名称"},{default:m((e=>[p(d,{modelValue:e.row.title,"onUpdate:modelValue":l=>e.row.title=l,style:{width:"calc(100% - 150px)"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),1===V.dictType?(u(),h(i,{key:0,label:"值"},{default:m((e=>[p(d,{modelValue:e.row.dicValue,"onUpdate:modelValue":l=>e.row.dicValue=l},null,8,["modelValue","onUpdate:modelValue"])])),_:1})):C("",!0),p(i,{align:"center",label:"操作",width:"150px"},{default:m((e=>[p(t,{disabled:!e.row.id,circle:"",icon:"Plus",size:"small",onClick:l=>{return(a=e.row).children||(a.children=[]),void a.children.push({title:"",dicValue:"",parentId:a.id,dicCode:V.dicCode});var a}},null,8,["disabled","onClick"]),p(t,{circle:"",icon:"Check",size:"small",type:"primary",onClick:l=>x(e.row)},null,8,["onClick"]),p(t,{disabled:!e.row.id,circle:"",icon:"Delete",size:"small",type:"danger",onClick:l=>{return d=e.row,void a({ids:[d.id]}).then((()=>{w({showClose:!0,message:"删除成功！",type:"success"}),g()}));var d}},null,8,["disabled","onClick"])])),_:1})])),_:1},8,["data"]),p(t,{style:{width:"100%","margin-top":"20px"},type:"primary",onClick:k},{default:m((()=>[y("添加新的项目 ")])),_:1})])),[[_,b.value]])}}});export{V as _};
