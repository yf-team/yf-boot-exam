import{d as e,r as a,al as t,y as l,z as s,m as o,p as n,o as i,c as r,g as u,aj as d,f as c,w as p,s as v,a as m,i as y,A as f,F as h,G as g,t as b,B as k,L as w,K as _}from"./index-20708d06.js";/* empty css                   *//* empty css                  *//* empty css                 */const x={"element-loading-text":"加载中..."},C={class:"search-box"},j={class:"search-items"},z={class:"opt-box"},B={class:"opt-box-left"},T={class:"opt-box-right"},D={class:"paging-box"},E=e({__name:"DataTable",props:{options:{type:Object,default:()=>({})},query:{type:Object,default:()=>({current:1,size:10,params:{}})}},emits:["onAdd","onEdit","onDelete","onBatch"],setup(e,{expose:E,emit:S}){const A=e,K=a(1),L=a([]),U=a(0),q=a(!1),O=a([]),P=a({}),{listUrl:R,delUrl:$,rowKey:F,add:G,edit:M,del:H,ip:I,op:J,batch:N}=t(A.options),{query:Q}=t(A),V=()=>{Q.value.current=1,te()},W=e=>{let a=[];e.forEach((e=>{a.push(e.id)})),O.value=a},X=e=>{P.value=e},Y=()=>{S("onAdd",P.value)},Z=()=>{S("onEdit",m(P.value[0]))},ee=()=>{k.confirm("确实要删除选定的数据吗?","提示信息",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{S("onDelete",m(O)),w.post({url:null==$?void 0:$.value,data:{ids:O.value}}).then((()=>{_({showClose:!0,message:"删除成功！",type:"success"}),te()}))}))},ae=()=>{te()},te=()=>{q.value=!0,w.post({url:R.value,data:Q.value}).then((e=>{const a=e.data;K.value=Q.value.current,L.value=a.records,U.value=a.total,q.value=!1}))},le=e=>{Q.value.current=1,Q.value.size=e,te()},se=e=>{Q.value.current=e,te()};return l((()=>{te()})),E({reload:ae}),(e,a)=>{const t=s("el-button"),l=s("arrow-down"),E=s("el-icon"),A=s("el-dropdown-item"),P=s("el-dropdown-menu"),R=s("el-dropdown"),$=s("el-table"),oe=s("el-pagination"),ne=o("hasPermi"),ie=o("loading");return n((i(),r("div",x,[u("div",C,[u("div",j,[d(e.$slots,"search")]),c(t,{icon:"Search",type:"primary",onClick:V},{default:p((()=>[v("搜索")])),_:1}),c(t,{icon:"RefreshLeft",onClick:a[0]||(a[0]=e=>(Q.value.params={},void V()))},{default:p((()=>[v("重置")])),_:1})]),u("div",z,[u("div",B,[m(G)&&m(G).enable?n((i(),y(t,{key:0,class:"filter-item",icon:"Plus",type:"primary",onClick:Y},{default:p((()=>[v("添加 ")])),_:1})),[[ne,m(G).permission]]):f("",!0),m(M)&&m(M).enable?n((i(),y(t,{key:1,disabled:0===O.value.length,class:"filter-item",icon:"Edit",type:"success",onClick:Z},{default:p((()=>[v("修改 ")])),_:1},8,["disabled"])),[[ne,m(M).permission]]):f("",!0),m(H)&&m(H).enable?n((i(),y(t,{key:2,disabled:0===O.value.length,class:"filter-item",icon:"Delete",type:"danger",onClick:ee},{default:p((()=>[v("删除 ")])),_:1},8,["disabled"])),[[ne,m(H).permission]]):f("",!0),m(I)&&m(I).enable?n((i(),y(t,{key:3,class:"filter-item",icon:"Upload"},{default:p((()=>[v("导入 ")])),_:1})),[[ne,m(I).permission]]):f("",!0),m(J)&&m(J).enable?n((i(),y(t,{key:4,class:"filter-item",icon:"Download"},{default:p((()=>[v("导出 ")])),_:1})),[[ne,m(J).permission]]):f("",!0),O.value.length>0&&m(N)?(i(),y(R,{key:5,style:{"margin-left":"10px"}},{dropdown:p((()=>[c(P,null,{default:p((()=>[(i(!0),r(h,null,g(m(N),((e,a)=>(i(),y(A,{key:a,onClick:a=>{return t=e,void k.confirm("确认要批量操作吗?","提示信息",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{const e={ids:O.value,key:t.key};if(S("onBatch",e),t.action){let e=t.params||{};e[t.idsKey||"ids"]=O.value,w.post({url:t.action,data:e}).then((()=>{_({showClose:!0,message:"操作成功！",type:"success"}),te()}))}}));var t}},{default:p((()=>[v(b(e.label),1)])),_:2},1032,["onClick"])))),128))])),_:1})])),default:p((()=>[c(t,{plain:"",type:"primary"},{default:p((()=>[v(" 批量操作 "),c(E,{class:"el-icon--right"},{default:p((()=>[c(l)])),_:1})])),_:1})])),_:1})):f("",!0)]),u("div",T,[c(t,{circle:"",icon:"Refresh",size:"small",onClick:ae})])]),c($,{data:L.value,"row-key":m(F)||"id",stripe:"",style:{width:"100%"},onSelect:X,onSelectionChange:W},{default:p((()=>[d(e.$slots,"columns")])),_:3},8,["data","row-key"]),u("div",D,[c(oe,{"current-page":K.value,"page-sizes":[10,50,100,500],total:U.value,background:"",layout:"total, sizes, prev, pager, next",onSizeChange:le,onCurrentChange:se},null,8,["current-page","total"])])])),[[ie,q.value]])}}});export{E as _};
